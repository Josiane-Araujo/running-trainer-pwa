<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0a1e">
    <title>Running Trainer</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Pequeno estilo embutido para a barra de progresso e modal */
        .treino-container { display:flex; flex-direction:column; gap:16px; align-items:center; padding: 20px; }
        .fase-atual { font-size:22px; font-weight:700; text-align:center; white-space:pre-line; }
        .info-principal { display:flex; gap:12px; width:100%; justify-content:center; }
        .info-box { background: rgba(255,255,255,0.03); padding:10px 14px; border-radius:10px; text-align:center; min-width:130px; }
        .info-label { font-size:12px; color:#ccc; }
        .info-valor { font-size:20px; font-weight:700; }
        .info-valor-small { font-size:16px; }
        .indicador-fase { width: 80%; height: 12px; border-radius: 8px; background: rgba(255,255,255,0.06); overflow:hidden; margin-top: 6px; }
        .indicador-fase .bar { height:100%; width:0%; background: linear-gradient(90deg,#00cc66,#009944); transition: width 400ms linear; }
        .indicador-fase.caminhada .bar { background: linear-gradient(90deg,#ffd166,#ff9f1c); }
        .controles { display:flex; gap:10px; }
        .btn { padding:10px 14px; border-radius:8px; cursor:pointer; border:none; }
        .btn-primary { background:#667eea; color:white; }
        .btn-secondary { background:#444; color:white; }
        .btn-success { background:#00aa44; color:white; }
        .btn-warning { background:#ffcc00; color:#111; }
        .btn-danger { background:#e63946; color:white; }
        .modal { position:fixed; left:0; right:0; top:0; bottom:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,0.6); z-index:2000; }
        .modal.active { display:flex; }
        .modal-content { background:white; padding:20px; width:90%; max-width:420px; border-radius:12px; color:#111; }
        .form-group { margin-bottom:12px; }
        input[type=number], select { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; font-size:14px; }
        label { display:block; margin-bottom:6px; color:#eee; }
        body { background: #07071a; color: #eaeef6; font-family: Arial, Helvetica, sans-serif; margin:0; padding:0; }
        .container { padding:20px; max-width:520px; margin:0 auto; }
        .screen { display:none; min-height:100vh; padding-top:24px; }
        .screen.active { display:block; }
        .title { text-align:center; margin-bottom:4px; }
        .subtitle { text-align:center; margin-bottom:18px; color:#cbd5e1; }
        .button-group { display:flex; gap:8px; flex-direction:column; }
        .info-text { color:#bcd; font-size:13px; }
        .warning-text { color:#b33; }
    </style>
</head>
<body>
    <!-- Tela Menu -->
    <div id="menuScreen" class="screen active">
        <div class="container">
            <h1 class="title">Running Trainer</h1>
            <p class="subtitle">Escolha o tipo de treino</p>
            
            <!-- Seletor de Voz no Menu -->
            <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                <label style="display: block; color: #e0e0e0; margin-bottom: 8px; font-size: 14px;">
                    üé§ Voz do Assistente:
                </label>
                <select id="seletorVozMenu" onchange="atualizarVoz(); sincronizarSeletores();" style="width: 100%; padding: 10px; font-size: 14px; border-radius: 8px; border: none; background: white; color: #333;">
                    <option value="auto">ü§ñ Autom√°tico</option>
                    <option value="feminina">üë© Feminina (Maria)</option>
                    <option value="masculina">üë® Masculina (Daniel)</option>
                </select>

                <button id="btnTestarVozMenu" class="btn" style="width:100%; margin-top:10px; background: linear-gradient(135deg, #00cc66 0%, #009944 100%); font-size: 16px; color:white;" onclick="testarVozManual()">
                    üé§ Testar voz
                </button>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="showScreen('tempoScreen')">
                    Treino por TEMPO
                </button>
                <button class="btn btn-secondary" onclick="showScreen('distanciaScreen')">
                    Treino por DIST√ÇNCIA
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Treino por Tempo -->
    <div id="tempoScreen" class="screen">
           <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">‚Üê Voltar</button>
                <h2 style="margin:0; flex:1;">Treino por Tempo</h2>
            </div>

            <div class="form">
                <div class="form-group">
                    <label>1¬∫ Tempo de CORRIDA (minutos) ‚≠ê (obrigat√≥rio)</label>
                    <input type="number" id="tempoCorrida1" placeholder="Ex: 20" min="1" max="999">
                </div>

                <div class="form-group">
                    <label>Tempo de CAMINHADA (minutos) (opcional)</label>
                    <input type="number" id="tempoCaminhada" placeholder="Ex: 2 (opcional)" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>2¬∫ Tempo de CORRIDA (minutos) (opcional)</label>
                    <input type="number" id="tempoCorrida2" placeholder="Ex: 10 (opcional)" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>N√∫mero de REPETI√á√ïES ‚≠ê (obrigat√≥rio) (1‚Äì99)</label>
                    <input type="number" id="repeticoes" placeholder="Ex: 8" min="1" max="99">
                </div>

                <button class="btn btn-success" onclick="iniciarTreinoTempo()">
                    INICIAR TREINO
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Treino por Dist√¢ncia -->
    <div id="distanciaScreen" class="screen">
         <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">‚Üê Voltar</button>
                <h2 style="margin:0; flex:1;">Treino por Dist√¢ncia</h2>
            </div>

            <div class="form">
                <div class="form-group">
                    <label>1¬™ Dist√¢ncia de CORRIDA (km) ‚≠ê (obrigat√≥rio)</label>
                    <input type="number" id="distCorrida1" placeholder="Ex: 0.2 (200m) ou 2" step="0.01" min="0.01" max="999">
                </div>

                <div class="form-group">
                    <label>Dist√¢ncia de CAMINHADA (km) (opcional)</label>
                    <input type="number" id="distCaminhada" placeholder="Ex: 0.1 (opcional)" step="0.01" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>2¬™ Dist√¢ncia de CORRIDA (km) (opcional)</label>
                    <input type="number" id="distCorrida2" placeholder="Ex: 0.1 (opcional)" step="0.01" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>N√∫mero de REPETI√á√ïES ‚≠ê (obrigat√≥rio) (1‚Äì99)</label>
                    <input type="number" id="repeticoesDist" placeholder="Ex: 8" min="1" max="99">
                </div>

                <p class="info-text">üìç GPS ser√° ativado durante o treino</p>

                <button class="btn btn-success" onclick="iniciarTreinoDistancia()">
                    INICIAR TREINO
                </button>
            </div>
        </div>
    </div>

    <!-- Tela de Treino -->
<div id="treinoScreen" class="screen">
    <div class="container treino-container">
        <div class="fase-atual" id="faseAtual">Preparar</div>

        <div class="info-principal">
            <div class="info-box">
                <div class="info-label" id="infoLabel">Tempo Restante</div>
                <div class="info-valor" id="infoValor">00:00</div>
            </div>

            <div class="info-box">
                <div class="info-label">Repeti√ß√µes</div>
                <div class="info-valor-small" id="repeticoesDisplay">0 / 0</div>
            </div>
        </div>

        <div class="indicador-fase" id="indicadorFase">
            <div class="bar" id="barraProgresso" style="width:0%"></div>
        </div>

        <div style="width:80%; display:flex; justify-content:space-between; font-size:12px; color:#bcd;">
            <div id="progressoTextoLeft">0%</div>
            <div id="progressoTextoRight">Meta</div>
        </div>

        <div class="controles">
            <button class="btn btn-warning" id="btnPausar" onclick="pausarTreino()">
                PAUSAR
            </button>
            <button class="btn btn-danger" onclick="finalizarTreino()">
                FINALIZAR
            </button>
        </div>

        <div class="info-extra" id="infoExtra"></div>
    </div>
</div>

    <!-- Modal de Permiss√µes -->
    <div id="permissionModal" class="modal">
        <div class="modal-content">
            <h3>‚ö° Configura√ß√£o Importante</h3>
            
            <!-- Seletor de Voz -->
            <div style="background: #f8fafc; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <label style="display: block; font-weight: bold; color: #333; margin-bottom: 10px;">
                    üé§ Escolha a voz do assistente:
                </label>
                <select id="seletorVoz" onchange="atualizarVoz(); sincronizarSeletores();" style="width: 100%; padding: 12px; font-size: 16px; border-radius: 8px; border: 2px solid #667eea; background: white;">
                    <option value="auto">ü§ñ Autom√°tico (Melhor dispon√≠vel)</option>
                    <option value="feminina">üë© Voz Feminina (Maria)</option>
                    <option value="masculina">üë® Voz Masculina (Daniel)</option>
                </select>
                <button id="btnTestarVozModal" class="btn" style="width: 100%; margin-top: 10px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer;" onclick="testarVozSelecionada()">
                    üîä Testar Voz Selecionada
                </button>
            </div>
            
            <p>Para o app funcionar com a tela bloqueada, voc√™ precisa:</p>
            <ul>
                <li>üó£Ô∏è <strong>Voz Sintetizada</strong> - Alertas falados em portugu√™s</li>
                <li>üîä <strong>√Åudio</strong> - Sons de alerta (beeps)</li>
                <li>üì≥ <strong>Vibra√ß√£o</strong> - Alertas t√°teis</li>
                <li>üîî <strong>Notifica√ß√µes</strong> - Alertas na tela bloqueada</li>
                <li>üîí <strong>Tela Ligada</strong> - Mant√©m app ativo</li>
                <li>üìç <strong>Localiza√ß√£o</strong> - Para treino por dist√¢ncia</li>
            </ul>
            <p class="warning-text">‚ö†Ô∏è <strong>IMPORTANTE:</strong> Durante o treino, mantenha o app aberto (pode bloquear a tela). N√£o feche o app nem abra outros aplicativos. Voc√™ ouvir√° avisos como "Iniciando primeira repeti√ß√£o" e "CORRIDA!".</p>
            <button class="btn btn-primary" onclick="requestPermissions()">
                üé§ ATIVAR VOZ E PERMITIR
            </button>
            <p style="font-size: 12px; color: #666; margin-top: 10px; text-align: center;">
                Clique no bot√£o acima para ativar a voz sintetizada.<br>
                Voc√™ ouvir√° uma mensagem de confirma√ß√£o.
            </p>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
