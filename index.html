<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0a1e">
    <title>Running Trainer</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Tela Menu Principal -->
    <div id="menuScreen" class="screen active">
        <div class="container">
            <h1 class="title">Running Trainer</h1>
            <p class="subtitle">Treinos Profissionais de Corrida</p>
            
            <!-- Seletor de Voz no Menu -->
            <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                <label style="display: block; color: #e0e0e0; margin-bottom: 8px; font-size: 14px;">
                    ğŸ¤ Voz do Assistente:
                </label>
                <select id="seletorVozMenu" onchange="atualizarVoz(); sincronizarSeletores();" style="width: 100%; padding: 10px; font-size: 14px; border-radius: 8px; border: none; background: white; color: #333;">
                    <option value="auto">ğŸ¤– AutomÃ¡tico</option>
                    <option value="feminina">ğŸ‘© Feminina (Maria)</option>
                    <option value="masculina">ğŸ‘¨ Masculina (Daniel)</option>
                </select>

                <button id="btnTestarVozMenu" class="btn" style="width:100%; margin-top:10px; background: linear-gradient(135deg, #00cc66 0%, #009944 100%); font-size: 16px; color:white;" onclick="testarVozManual()">
                    ğŸ¤ Testar voz
                </button>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="showScreen('perfilScreen')">
                    âš™ï¸ Configurar Perfil
                </button>
                <button class="btn btn-secondary" onclick="showScreen('treinosFixosScreen')">
                    ğŸ“‹ Treinos Fixos
                </button>
                <button class="btn btn-primary" onclick="showScreen('tempoScreen')">
                    â±ï¸ Treino por TEMPO
                </button>
                <button class="btn btn-secondary" onclick="showScreen('distanciaScreen')">
                    ğŸ“ Treino por DISTÃ‚NCIA
                </button>
                <button class="btn" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);" onclick="abrirAnaliseFC()">
                    â¤ï¸ FrequÃªncia CardÃ­aca
                </button>
                <button class="btn" style="background: linear-gradient(135deg, #ffa500 0%, #ff8c00 100%);" onclick="abrirAnaliseCadencia()">
                    ğŸƒ AnÃ¡lise de CadÃªncia
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Configurar Perfil -->
    <div id="perfilScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;">Seu Perfil</h2>
            </div>

            <div class="form" style="margin-top: 20px;">
                <div class="form-group">
                    <label>ğŸ‘¤ Nome</label>
                    <input type="text" id="inputNome" placeholder="Seu nome" value="">
                </div>

                <div class="form-group">
                    <label>ğŸ‚ Idade (anos)</label>
                    <input type="number" id="inputIdade" placeholder="Ex: 30" min="15" max="100" value="">
                </div>

                <div class="form-group">
                    <label>ğŸ“ Altura (metros)</label>
                    <input type="number" id="inputAltura" placeholder="Ex: 1.75" step="0.01" min="1.40" max="2.30" value="">
                </div>

                <div class="form-group">
                    <label>ğŸƒ NÃ­vel de ExperiÃªncia</label>
                    <select id="selectNivel" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; font-size:14px; background: white; color: #333;">
                        <option value="Iniciante">Iniciante</option>
                        <option value="IntermediÃ¡rio">IntermediÃ¡rio</option>
                        <option value="AvanÃ§ado">AvanÃ§ado</option>
                    </select>
                </div>

                <button class="btn btn-success" onclick="salvarPerfilUI()">
                    âœ… Salvar Perfil
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Treinos Fixos -->
    <div id="treinosFixosScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;">Treinos Fixos</h2>
            </div>

            <div class="button-group" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="selecionarTreino('5k_iniciante')">
                    ğŸƒ 5K Iniciante (8 semanas)
                </button>
                <button class="btn btn-primary" onclick="selecionarTreino('5k_sub30')">
                    âš¡ 5K Sub 30 (6 semanas)
                </button>
                <button class="btn btn-primary" onclick="selecionarTreino('10k')">
                    ğŸ† 10K (8 semanas)
                </button>
            </div>
        </div>
    </div>

    <!-- Tela SeleÃ§Ã£o de Semana/Dia -->
    <div id="semanadiaScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('treinosFixosScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;" id="tituloTreinoSelecionado">Selecione a Semana</h2>
            </div>

            <div id="containerSemanas" class="button-group" style="margin-top: 20px;">
                <!-- Preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Tela SeleÃ§Ã£o de Dia (A/B/C) -->
    <div id="diaScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('semanadiaScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;" id="tituloDiaScreen">Selecione o Dia</h2>
            </div>

            <div id="containerDias" class="button-group" style="margin-top: 20px;">
                <!-- Preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Tela Treino por Tempo -->
    <div id="tempoScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;">Treino por Tempo</h2>
            </div>

            <div class="form" style="margin-top: 20px;">
                <div class="form-group">
                    <label>1Âº Tempo de CORRIDA (minutos) â­</label>
                    <input type="number" id="tempoCorrida1" placeholder="Ex: 20" min="1" max="999">
                </div>

                <div class="form-group">
                    <label>Tempo de CAMINHADA (minutos) (opcional)</label>
                    <input type="number" id="tempoCaminhada" placeholder="Ex: 2" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>2Âº Tempo de CORRIDA (minutos) (opcional)</label>
                    <input type="number" id="tempoCorrida2" placeholder="Ex: 10" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>NÃºmero de REPETIÃ‡Ã•ES â­ (1â€“99)</label>
                    <input type="number" id="repeticoes" placeholder="Ex: 8" min="1" max="99">
                </div>

                <button class="btn btn-success" onclick="iniciarTreinoTempo()">
                    â–¶ï¸ INICIAR TREINO
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Treino por DistÃ¢ncia -->
    <div id="distanciaScreen" class="screen">
        <div class="container">
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
                <button class="btn btn-secondary" onclick="showScreen('menuScreen')">â† Voltar</button>
                <h2 style="margin:0; flex:1;">Treino por DistÃ¢ncia</h2>
            </div>

            <div class="form" style="margin-top: 20px;">
                <div class="form-group">
                    <label>1Âª DistÃ¢ncia de CORRIDA (km) â­</label>
                    <input type="number" id="distCorrida1" placeholder="Ex: 0.2 ou 2" step="0.01" min="0.01" max="999">
                </div>

                <div class="form-group">
                    <label>DistÃ¢ncia de CAMINHADA (km) (opcional)</label>
                    <input type="number" id="distCaminhada" placeholder="Ex: 0.1" step="0.01" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>2Âª DistÃ¢ncia de CORRIDA (km) (opcional)</label>
                    <input type="number" id="distCorrida2" placeholder="Ex: 0.1" step="0.01" min="0" max="999">
                </div>

                <div class="form-group">
                    <label>NÃºmero de REPETIÃ‡Ã•ES â­ (1â€“99)</label>
                    <input type="number" id="repeticoesDist" placeholder="Ex: 8" min="1" max="99">
                </div>

                <p class="info-text">ğŸ“ GPS serÃ¡ ativado durante o treino</p>

                <button class="btn btn-success" onclick="iniciarTreinoDistancia()">
                    â–¶ï¸ INICIAR TREINO
                </button>
            </div>
        </div>
    </div>

    <!-- Tela de Treino -->
    <div id="treinoScreen" class="screen">
        <div class="container treino-container">
            <div class="fase-atual" id="faseAtual">Preparar</div>

            <div class="info-principal">
                <div class="info-box">
                    <div class="info-label" id="infoLabel">Tempo Restante</div>
                    <div class="info-valor" id="infoValor">00:00</div>
                </div>

                <div class="info-box">
                    <div class="info-label">RepetiÃ§Ãµes</div>
                    <div class="info-valor-small" id="repeticoesDisplay">0 / 0</div>
                </div>
            </div>

            <div class="indicador-fase" id="indicadorFase">
                <div class="bar" id="barraProgresso" style="width:0%"></div>
            </div>

            <div style="width:80%; display:flex; justify-content:space-between; font-size:12px; color:#bcd;">
                <div id="progressoTextoLeft">0%</div>
                <div id="progressoTextoRight">Meta</div>
            </div>

            <div class="controles">
                <button class="btn btn-warning" id="btnPausar" onclick="pausarTreino()">
                    PAUSAR
                </button>
                <button class="btn btn-danger" onclick="finalizarTreino()">
                    FINALIZAR
                </button>
            </div>

            <div class="info-extra" id="infoExtra"></div>
        </div>
    </div>

    <!-- Modal de PermissÃµes -->
    <div id="permissionModal" class="modal">
        <div class="modal-content">
            <h3>âš¡ ConfiguraÃ§Ã£o Importante</h3>
            
            <!-- Seletor de Voz -->
            <div style="background: #f8fafc; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <label style="display: block; font-weight: bold; color: #333; margin-bottom: 10px;">
                    ğŸ¤ Escolha a voz do assistente:
                </label>
                <select id="seletorVoz" onchange="atualizarVoz(); sincronizarSeletores();" style="width: 100%; padding: 12px; font-size: 16px; border-radius: 8px; border: 2px solid #667eea; background: white;">
                    <option value="auto">ğŸ¤– AutomÃ¡tico (Melhor disponÃ­vel)</option>
                    <option value="feminina">ğŸ‘© Voz Feminina (Maria)</option>
                    <option value="masculina">ğŸ‘¨ Voz Masculina (Daniel)</option>
                </select>
                <button id="btnTestarVozModal" class="btn" style="width: 100%; margin-top: 10px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer;" onclick="testarVozSelecionada()">
                    ğŸ”Š Testar Voz Selecionada
                </button>
            </div>
            
            <p>Para o app funcionar com a tela bloqueada, vocÃª precisa:</p>
            <ul>
                <li>ğŸ—£ï¸ <strong>Voz Sintetizada</strong> - Alertas falados em portuguÃªs</li>
                <li>ğŸ”Š <strong>Ãudio</strong> - Sons de alerta (beeps)</li>
                <li>ğŸ“³ <strong>VibraÃ§Ã£o</strong> - Alertas tÃ¡teis</li>
                <li>ğŸ”” <strong>NotificaÃ§Ãµes</strong> - Alertas na tela bloqueada</li>
                <li>ğŸ”’ <strong>Tela Ligada</strong> - MantÃ©m app ativo (Wake Lock)</li>
                <li>ğŸ“ <strong>LocalizaÃ§Ã£o</strong> - Para treino por distÃ¢ncia</li>
            </ul>
            <p class="warning-text">âš ï¸ <strong>IMPORTANTE:</strong> Durante o treino, mantenha o app aberto (pode bloquear a tela). VocÃª ouvirÃ¡ avisos como "CORRIDA!" e "Caminhada!".</p>
            <button class="btn btn-primary" onclick="requestPermissions()">
                ğŸ¤ ATIVAR VOZ E PERMITIR
            </button>
            <p style="font-size: 12px; color: #666; margin-top: 10px; text-align: center;">
                Clique no botÃ£o acima para ativar a voz sintetizada.<br>
                VocÃª ouvirÃ¡ uma mensagem de confirmaÃ§Ã£o.
            </p>
        </div>
    </div>

    <script src="treinos_fixos.js"></script>
    <script src="app.js"></script>
    <script>
        // Script para gerenciar seleÃ§Ã£o de treinos fixos
        let treinoFixoSelecionado = null;
        let semanaSelecionada = null;

        function selecionarTreino(treinoId) {
            treinoFixoSelecionado = treinoId;
            const treino = TREINOS_FIXOS[treinoId];
            
            const container = document.getElementById('containerSemanas');
            container.innerHTML = '';
            
            Object.keys(treino.semanas).forEach(semana => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-primary';
                btn.textContent = `Semana ${semana}`;
                btn.onclick = () => selecionarSemana(semana);
                container.appendChild(btn);
            });

            document.getElementById('tituloTreinoSelecionado').textContent = treino.nome;
            showScreen('semanadiaScreen');
        }

        function selecionarSemana(semana) {
            semanaSelecionada = semana;
            const treino = TREINOS_FIXOS[treinoFixoSelecionado];
            const semanal = treino.semanas[semana];
            
            const container = document.getElementById('containerDias');
            container.innerHTML = '';
            
            Object.keys(semanal).forEach(dia => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-secondary';
                btn.textContent = `Dia ${dia}`;
                btn.onclick = () => iniciarTreinoFixo(treinoFixoSelecionado, semana, dia);
                container.appendChild(btn);
            });

            document.getElementById('tituloDiaScreen').textContent = `${treino.nome} - Semana ${semana}`;
            showScreen('diaScreen');
        }

        function salvarPerfilUI() {
            const nome = document.getElementById('inputNome').value.trim();
            const idade = document.getElementById('inputIdade').value;
            const altura = document.getElementById('inputAltura').value;
            const nivel = document.getElementById('selectNivel').value;

            if (!nome || !idade || !altura) {
                alert('âš ï¸ Preencha todos os campos!');
                return;
            }

            atualizarPerfil(nome, idade, altura, nivel);
            alert('âœ… Perfil salvo com sucesso!');
            showScreen('menuScreen');
        }

        // Carregar dados do perfil ao abrir tela
        window.addEventListener('load', () => {
            setTimeout(() => {
                carregarPerfil();
                document.getElementById('inputNome').value = perfil.nome;
                document.getElementById('inputIdade').value = perfil.idade;
                document.getElementById('inputAltura').value = perfil.altura;
                document.getElementById('selectNivel').value = perfil.nivel;
            }, 500);
        });
    </script>
</body>
</html>